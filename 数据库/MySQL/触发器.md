## 一、SQL server

#### 1.1、创建触发器

```sql
--触发器的创建
CREATE TRIGGER trigger_name -- 创建触发器trigger_name为触发器名称
ON { table_name | view_name } -- 表示给表或者视图创建触发器
{ FOR | After | Instead OF } --- for和after表示表或者视图执行完增、删、改之后才会触发，Instead of表示执行sql语句之前触发
[ insert, update,delete ] -- 设置监测表执行何种状态触发，例如insert 表示执行插入操作，才会触发
AS sql_statement -- 设置触发器需要执行的sql 语句
```

#### 1.2、删除触发器

```sql
-- 触发器的删除
DROP TRIGGER trigger_name -- 触发器的修改
ALTER TRIGGER trigger_name ON { table_name | view_name }
{ FOR | After | Instead OF } [ insert, update,delete ] AS sql_statement
```

#### 1.3、查看触发器

```sql
-- 查看表中的触发器类型
EXEC sp_helptrigger uf_kjjlb
-- 报告有关数据库对象（sys.sysobjects 兼容视图中列出的所有对象）、用户定义数据类型或某种数据类型的信息
EXEC sp_help 'trigger_uf_kjjlb'
-- sp_helptext:显示规则、默认值、未加密的存储过程、用户定义函数、触发器或视图的文本
EXEC sp_helptext 'trigger_uf_kjjlb'
```

#### 1.4、示例

```sql
--- 创建触发器 
--- trigger_uf_kjjlb 触发器名称
--- uf_kjjlb 表名
--- After 更新时机，插入后更新
--- INSERT 插入时更新
CREATE TRIGGER trigger_uf_kjjlb ON uf_kjjlb After INSERT AS DECLARE
--- 字段声明
@id INT;
--- 从插入记录中取值
SELECT
	@id = id 
FROM
	inserted;
--- 更新字段值
UPDATE uf_kjjlb 
SET formmodeid = 28,
modedatacreater = 1,
modedatacreatertype = 0,
modedatacreatedate = CONVERT ( DATE, SYSDATETIME ( ) ),
modedatacreatetime = CONVERT ( TIME, SYSDATETIME ( ) ); 
```

